package modelo;
/**/
import java.sql.Connection;
import java.sql.DriverManager;

public class Conexion3 {
	
	private String bd; 
	private String usuario;
	private String contrasenia;
	private String servidor;
	private Conexion3 instancia;
	private Connection con;
	
	/*
	 * Constructor sin parametros que permitira definir un dato por default de la clase
	 */
	
	private Conexion3(){
		bd = "dvdrental";
		usuario = "postgres";
		contrasenia = "maki3001";
		servidor = "jdbc:postgresql://localhost:5432";
		con= null;
	}
	
	/*
	 * Constructor con parametros que permita inicializar con valores personalizados
	 */
	
	private Conexion3(String bd, String usuario, String contrasenia){
		this.bd = bd;
		this.usuario = usuario;
		this.contrasenia = contrasenia;
		this.servidor = "jdbc:postgresql://localhost:5432";
		con= null;
	}
	
	/*
	 * Metodo para recuperar la instancia de la clase de conexion
	 */
	
	public Conexion3 getInstance(){
		if(instancia == null)
			{
				instancia = new Conexion3();
			}
		return instancia;
	}
	
	/*
	 * Método para conectar al servidor Postgresql
	 */
	
	public String conectar(){
		try {
			//verifica que este el driver en el proyecto
			Class.forName("org.postgresql.Driver"); 
			con = DriverManager.getConnection(servidor+bd, usuario, contrasenia);
			System.out.println("Se hizo la conexión");
			return "Conexion éxitosa";
			
		} catch (Exception e) {
			// TODO: handle exception
			e.printStackTrace();
			return "No se establecio la conexión, Consulta a su administrador.";
		}
	}
	
	/*
	 * Método para desconectar del servidor de Postgresql
	 */
	
	public String desconectar(){
		try {
			//Cerrar la conexión
			con.close();
			System.out.println("Se ha desconectado del servidor");
			return "Se ha desconectado del servidor";
		} catch (Exception e) {
			// TODO: handle exception
			e.printStackTrace();
			return "La conexión está siendo ocupada. No se puede desconectar.";
		}
	}
}
